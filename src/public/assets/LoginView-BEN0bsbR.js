import{_ as k,c as f,a as n,b as o,u as r,P,t as g,d as V,w as i,e as x,r as u,f as B,o as w,g as I,h as S}from"./index-Dq3TnNJu.js";import{N as C,a as _}from"./FormItem-JjeF8lCF.js";import{N as b}from"./Input-WxvPfhkY.js";import{B as A}from"./Button-B-y_Fy3n.js";const R={class:"login-container"},T={class:"login-card"},j={class:"login-header"},q={class:"login-logo"},E={key:0,class:"login-error"},F={__name:"LoginView",setup(H){const h=B(),c=u(null),a=u(!1),s=u(""),t=u({username:"",password:""}),y={username:{required:!0,message:"请输入用户名",trigger:"blur"},password:{required:!0,message:"请输入密码",trigger:"blur"}};function m(){s.value=""}async function d(){var l;try{await((l=c.value)==null?void 0:l.validate())}catch{return}const p=t.value.username.trim(),e=t.value.password;if(!p||!e){s.value="请输入用户名和密码";return}a.value=!0,s.value="";try{const v=await fetch("/api/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:p,password:e})}),N=await v.json().catch(()=>({}));v.ok?h.push("/dashboard"):s.value=N.error||"登录失败"}catch{s.value="网络异常，请稍后重试"}finally{a.value=!1}}return(p,e)=>(w(),f("div",R,[n("div",T,[n("div",j,[n("div",q,[o(r(P),{size:24})]),e[2]||(e[2]=n("h1",null,"HiPrint Agent",-1)),e[3]||(e[3]=n("p",null,"请登录管理面板",-1))]),s.value?(w(),f("div",E,g(s.value),1)):V("",!0),o(r(C),{ref_key:"formRef",ref:c,model:t.value,rules:y,onSubmit:x(d,["prevent"])},{default:i(()=>[o(r(_),{label:"用户名",path:"username"},{default:i(()=>[o(r(b),{value:t.value.username,"onUpdate:value":e[0]||(e[0]=l=>t.value.username=l),placeholder:"请输入用户名",disabled:a.value,onInput:m},null,8,["value","disabled"])]),_:1}),o(r(_),{label:"密码",path:"password"},{default:i(()=>[o(r(b),{value:t.value.password,"onUpdate:value":e[1]||(e[1]=l=>t.value.password=l),type:"password","show-password-on":"click",placeholder:"请输入密码",disabled:a.value,onInput:m,onKeyup:I(d,["enter"])},null,8,["value","disabled"])]),_:1}),o(r(A),{type:"primary",block:"",loading:a.value,disabled:a.value,"attr-type":"submit",onClick:d},{default:i(()=>[S(g(a.value?"登录中...":"登录"),1)]),_:1},8,["loading","disabled"])]),_:1},8,["model"]),e[4]||(e[4]=n("div",{class:"login-footer"}," HiPrint Agent Admin Panel ",-1))])]))}},U=k(F,[["__scopeId","data-v-73721844"]]);export{U as default};
