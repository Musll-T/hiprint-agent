import{_ as L,bz as x,v as z,ak as C,c as r,b as n,w as o,u as s,r as m,o as i,x as B,y as S,a as g,t as u,h as d}from"./index-Dq3TnNJu.js";import{s as V}from"./format-PD0jBUzQ.js";import{B as T}from"./Button-B-y_Fy3n.js";import{a as E,b as M,N as A}from"./Space-C_T_MHn6.js";import{N as y}from"./Tag-D463yQp-.js";const D={class:"logs-view"},F={key:0,class:"logs-empty"},I={class:"log-time"},G={class:"log-detail"},O=200,U={__name:"LogsView",setup(X){const{on:v,off:h,isConnected:c}=x(),a=m([]),b=m(null),p={received:{label:"已接收",type:"default"},rendering:{label:"渲染中",type:"info"},printing:{label:"打印中",type:"info"},done:{label:"完成",type:"success"},failed_render:{label:"渲染失败",type:"error"},failed_print:{label:"打印失败",type:"error"},canceled:{label:"已取消",type:"warning"},timeout:{label:"超时",type:"warning"}};function f(e){var t;return((t=p[e])==null?void 0:t.label)||e}function N(e){var t;return((t=p[e])==null?void 0:t.type)||"default"}function _(e){const t={time:new Date().toLocaleTimeString("zh-CN",{hour:"2-digit",minute:"2-digit",second:"2-digit"}),action:e.status,detail:"任务 "+V(e.id)+" → "+f(e.status)+(e.printer?" ["+e.printer+"]":"")+(e.error_msg?" "+e.error_msg:"")};a.value.unshift(t),a.value.length>O&&a.value.pop()}function k(){a.value=[]}return z(()=>{v("job:update",_)}),C(()=>{h("job:update",_)}),(e,t)=>(i(),r("div",D,[n(s(E),{title:"实时日志",size:"small"},{"header-extra":o(()=>[n(s(A),{size:8},{default:o(()=>[n(s(y),{type:s(c)?"success":"error",size:"small",round:""},{default:o(()=>[d(u(s(c)?"已连接":"未连接"),1)]),_:1},8,["type"]),n(s(T),{size:"small",onClick:k},{default:o(()=>[...t[0]||(t[0]=[d("清空",-1)])]),_:1})]),_:1})]),default:o(()=>[a.value.length===0?(i(),r("div",F,[n(s(M),{description:"等待事件..."})])):(i(),r("div",{key:1,ref_key:"logContainer",ref:b,class:"logs-list"},[(i(!0),r(B,null,S(a.value,(l,w)=>(i(),r("div",{key:w,class:"log-entry"},[g("span",I,u(l.time),1),n(s(y),{type:N(l.action),size:"tiny",round:""},{default:o(()=>[d(u(f(l.action)),1)]),_:2},1032,["type"]),g("span",G,u(l.detail),1)]))),128))],512))]),_:1})]))}},Q=L(U,[["__scopeId","data-v-82f2a7bb"]]);export{Q as default};
